<section>
%% for (hostname, status) in &self.statuses {
  <article>
    <h2>{{ hostname }}</h2>
    <ul>
      <li>Disk: {{ status.display_disk_usage() }}%</li>
      <li>Memory: {{ status.display_memory_usage() }}%</li>
      <li>CPU: {{ status.display_cpu_usage() }}%</li>
      <li>Uptime: {{ status.display_uptime() }}</li>
%% if let Some(hashrate) = status.hashrate {
      <li> Hashrate: {{ hashrate }}</li>
%% }
%% if let Some(workers) = status.workers {
      <li>Workers: {{ workers }}</li>
%% }
%% if let Some(best_share) = status.best_share {
      <li>Workers: {{ best_share }}</li>
%% }
%% if let Some(sps) = status.sps {
      <li>Workers: {{ sps }}</li>
%% }
    </ul>
  </article>
  <br>
%% }
</section>

<div id="refresh" role="status" aria-live="polite">
  Updating in <strong id="count">60</strong>s
</div>

<style>
  #refresh {
    position: fixed;
    right: 14px;
    bottom: 14px;
    padding: 8px 14px;
    border-radius: 8px;
    background: #2457a6;
    color: #eef4ff;
    font: 14px/1.3 system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    font-weight: 500;
    letter-spacing: .2px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, .25);
    border: 1px solid rgba(255, 255, 255, .15);
    z-index: 2147483647;
    user-select: none;
  }
</style>

<script>
  (() => {
    const PERIOD = 60;
    let remaining = PERIOD;

    const refresh = document.getElementById('refresh');
    const count = document.getElementById('count');

    const tick = setInterval(() => {
      remaining -= 1;
      if (count) count.textContent = remaining;

      if (remaining <= 5) refresh.classList.add('pulse');
      if (remaining <= 0) {
        clearInterval(tick);
        refresh.innerHTML = '<span class="icon" aria-hidden="true">ðŸ”„</span>';
        location.reload();
      }
    }, 1000);

    setTimeout(() => location.reload(), (PERIOD * 1000) + 2000);
  })();
</script>
