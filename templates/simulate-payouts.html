<div style="display: block;">
    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px;">
        <div style="margin: 2px 10px 5px;">
            Simulate Payouts<br>
            <br>
            Coinbase Value: {{ self.display_coinbase_value() }}<br>
            %% if !self.winner_address.is_empty() {
            Block Finder: {{ self.winner_address }}<br>
            %% }
            Total Payouts: {{ self.display_count() }}<br>
            Total Amount: {{ self.display_total() }}
        </div>
        <div style="display: flex; flex-direction: column; gap: 10px;">
            <a href="{{ self.json_url() }}" download="simulated_payouts.json">Download JSON</a>
            <a href="{{ self.csv_url() }}" download="simulated_payouts.csv">Download CSV</a>
        </div>
    </div>
    <div style="margin-bottom: 20px;">
        <form method="get" action="/payouts/simulate" style="display: flex; gap: 10px; align-items: flex-end;">
            <div>
                <label for="coinbase_value">Coinbase Value (sats):</label><br>
                <input type="number" id="coinbase_value" name="coinbase_value" value="{{ self.coinbase_value }}" style="width: 200px;">
            </div>
            <div>
                <label for="winner_address">Block Finder (username):</label><br>
                <input type="text" id="winner_address" name="winner_address" value="{{ self.winner_address }}" style="width: 200px;">
            </div>
            <button type="submit">Simulate</button>
        </form>
    </div>
    <div>
        %% if !self.payouts.is_empty() {
        <h3>Simulated Payments</h3>
        <div style="overflow: auto; max-height: 500px;">
            <table border="1" cellpadding="5" cellspacing="0" style="width: 100%;">
                <tr>
                    <th>Lightning Address</th>
                    <th>Bitcoin Address</th>
                    <th>Amount</th>
                </tr>
                %% for payout in &self.payouts {
                <tr>
                    <td>{{ payout.ln_address }}</td>
                    <td>{{ payout.btc_address }}</td>
                    <td>{{ crate::subcommand::server::templates::simulate_payouts::format_sats(payout.amount_sats) }}</td>
                </tr>
                %% }
            </table>
        </div>
        %% } else {
        <p>No payouts to display. The coinbase value may be too small (must be > 1 BTC).</p>
        %% }
    </div>
</div>