#!/usr/bin/env bash
CLI="./bitcoin/build/bin/bitcoin-cli -datadir=./copr -signet"
MINER="./bitcoin/contrib/signet/miner"
GRIND="./bitcoin/build/bin/bitcoin-util grind"
# Anyone-can-spend P2WSH(OP_TRUE)
ADDR=tb1qft5p2uhsdcdc3l2ua4ap5qqfg4pjaqlp250x7us7a8qqhrxrxfsqaqh7jw
NBITS=1d00ffff
$CLI loadwallet copr || $CLI createwallet copr
HEIGHT=$($CLI getblockcount)
while [ $HEIGHT -lt 16 ]; do
  $MINER --cli="$CLI" generate --grind-cmd="$GRIND" --address="$ADDR" --nbits=$NBITS
  HEIGHT=$($CLI getblockcount)
done
